<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# sql

```go
import "github.com/aexvir/skladka/internal/storage/sql"
```

## Index

- [type CreatePasteParams](<#CreatePasteParams>)
- [type DBTX](<#DBTX>)
- [type Paste](<#Paste>)
  - [func \(Paste\) FromDomain\(domain paste.Paste\) \*Paste](<#Paste.FromDomain>)
  - [func \(db Paste\) ToDomain\(\) paste.Paste](<#Paste.ToDomain>)
- [type Queries](<#Queries>)
  - [func New\(db DBTX\) \*Queries](<#New>)
  - [func \(q \*Queries\) CreatePaste\(ctx context.Context, arg CreatePasteParams\) \(int64, error\)](<#Queries.CreatePaste>)
  - [func \(q \*Queries\) GetPasteByID\(ctx context.Context, id int64\) \(Paste, error\)](<#Queries.GetPasteByID>)
  - [func \(q \*Queries\) GetPasteByReference\(ctx context.Context, reference string\) \(Paste, error\)](<#Queries.GetPasteByReference>)
  - [func \(q \*Queries\) ListPublicPastes\(ctx context.Context\) \(\[\]Paste, error\)](<#Queries.ListPublicPastes>)
  - [func \(q \*Queries\) WithTx\(tx pgx.Tx\) \*Queries](<#Queries.WithTx>)


<a name="CreatePasteParams"></a>
## type [CreatePasteParams](<https://github.com/aexvir/skladka/blob/master/internal/storage/sql/pastes.sql.go#L21-L29>)



```go
type CreatePasteParams struct {
    Reference  string           `db:"reference" json:"reference"`
    Title      string           `db:"title" json:"title"`
    Content    string           `db:"content" json:"content"`
    Syntax     pgtype.Text      `db:"syntax" json:"syntax"`
    Tags       []string         `db:"tags" json:"tags"`
    Expiration pgtype.Timestamp `db:"expiration" json:"expiration"`
    Public     bool             `db:"public" json:"public"`
}
```

<a name="DBTX"></a>
## type [DBTX](<https://github.com/aexvir/skladka/blob/master/internal/storage/sql/db.go#L14-L18>)



```go
type DBTX interface {
    Exec(context.Context, string, ...interface{}) (pgconn.CommandTag, error)
    Query(context.Context, string, ...interface{}) (pgx.Rows, error)
    QueryRow(context.Context, string, ...interface{}) pgx.Row
}
```

<a name="Paste"></a>
## type [Paste](<https://github.com/aexvir/skladka/blob/master/internal/storage/sql/models.go#L11-L24>)



```go
type Paste struct {
    ID         int64            `db:"id" json:"id"`
    Reference  string           `db:"reference" json:"reference"`
    Title      string           `db:"title" json:"title"`
    Content    string           `db:"content" json:"content"`
    Syntax     pgtype.Text      `db:"syntax" json:"syntax"`
    Tags       []string         `db:"tags" json:"tags"`
    Expiration pgtype.Timestamp `db:"expiration" json:"expiration"`
    Public     bool             `db:"public" json:"public"`
    CreatedAt  pgtype.Timestamp `db:"created_at" json:"created_at"`
    UpdatedAt  pgtype.Timestamp `db:"updated_at" json:"updated_at"`
    DeletedAt  pgtype.Timestamp `db:"deleted_at" json:"deleted_at"`
    Views      pgtype.Int4      `db:"views" json:"views"`
}
```

<a name="Paste.FromDomain"></a>
### func \(Paste\) [FromDomain](<https://github.com/aexvir/skladka/blob/master/internal/storage/sql/transformation.go#L35>)

```go
func (Paste) FromDomain(domain paste.Paste) *Paste
```



<a name="Paste.ToDomain"></a>
### func \(Paste\) [ToDomain](<https://github.com/aexvir/skladka/blob/master/internal/storage/sql/transformation.go#L11>)

```go
func (db Paste) ToDomain() paste.Paste
```



<a name="Queries"></a>
## type [Queries](<https://github.com/aexvir/skladka/blob/master/internal/storage/sql/db.go#L24-L26>)



```go
type Queries struct {
    // contains filtered or unexported fields
}
```

<a name="New"></a>
### func [New](<https://github.com/aexvir/skladka/blob/master/internal/storage/sql/db.go#L20>)

```go
func New(db DBTX) *Queries
```



<a name="Queries.CreatePaste"></a>
### func \(\*Queries\) [CreatePaste](<https://github.com/aexvir/skladka/blob/master/internal/storage/sql/pastes.sql.go#L37>)

```go
func (q *Queries) CreatePaste(ctx context.Context, arg CreatePasteParams) (int64, error)
```

CreatePaste

```
insert into pastes
(reference, title, content, syntax, tags, expiration, public)
values ($1, $2, $3, $4, $5, $6, $7)
returning id
```

<a name="Queries.GetPasteByID"></a>
### func \(\*Queries\) [GetPasteByID](<https://github.com/aexvir/skladka/blob/master/internal/storage/sql/pastes.sql.go#L65>)

```go
func (q *Queries) GetPasteByID(ctx context.Context, id int64) (Paste, error)
```

GetPasteByID

```
select id, reference, title, content, syntax, tags, expiration, public, created_at, updated_at, deleted_at, views
from pastes
where id = $1
    and deleted_at is null
```

<a name="Queries.GetPasteByReference"></a>
### func \(\*Queries\) [GetPasteByReference](<https://github.com/aexvir/skladka/blob/master/internal/storage/sql/pastes.sql.go#L100>)

```go
func (q *Queries) GetPasteByReference(ctx context.Context, reference string) (Paste, error)
```

GetPasteByReference

```
update pastes
set views = views + 1
where reference = $1
    and deleted_at is null
returning id, reference, title, content, syntax, tags, expiration, public, created_at, updated_at, deleted_at, views
```

<a name="Queries.ListPublicPastes"></a>
### func \(\*Queries\) [ListPublicPastes](<https://github.com/aexvir/skladka/blob/master/internal/storage/sql/pastes.sql.go#L133>)

```go
func (q *Queries) ListPublicPastes(ctx context.Context) ([]Paste, error)
```

ListPublicPastes

```
select id, reference, title, content, syntax, tags, expiration, public, created_at, updated_at, deleted_at, views
from pastes
where public = true
order by created_at desc
```

<a name="Queries.WithTx"></a>
### func \(\*Queries\) [WithTx](<https://github.com/aexvir/skladka/blob/master/internal/storage/sql/db.go#L28>)

```go
func (q *Queries) WithTx(tx pgx.Tx) *Queries
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
